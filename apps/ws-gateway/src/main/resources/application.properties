# Server configuration
server.port=8080

# Application name
spring.application.name=ws-gateway
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/

# Gateway routes configuration
spring.cloud.gateway.routes[0].id=gibd-quant-signal
spring.cloud.gateway.routes[0].uri=lb://gibd-quant-signal
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/signals/**
spring.cloud.gateway.routes[0].filters[0]=StripPrefix=2

spring.cloud.gateway.routes[1].id=gibd-quant-nlq
spring.cloud.gateway.routes[1].uri=lb://gibd-quant-nlq
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/nlq/**
spring.cloud.gateway.routes[1].filters[0]=StripPrefix=2

spring.cloud.gateway.routes[2].id=gibd-quant-calibration
spring.cloud.gateway.routes[2].uri=lb://gibd-quant-calibration
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/calibrate/**
spring.cloud.gateway.routes[2].filters[0]=StripPrefix=2

spring.cloud.gateway.routes[3].id=gibd-quant-agent
spring.cloud.gateway.routes[3].uri=lb://gibd-quant-agent
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/agent/**,/api/reports/**
spring.cloud.gateway.routes[3].filters[0]=StripPrefix=2

spring.cloud.gateway.routes[4].id=ws-trades
spring.cloud.gateway.routes[4].uri=lb://ws-trades
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/trades/**
spring.cloud.gateway.routes[4].filters[0]=StripPrefix=2

spring.cloud.gateway.routes[5].id=ws-company
spring.cloud.gateway.routes[5].uri=lb://ws-company
spring.cloud.gateway.routes[5].predicates[0]=Path=/api/company/**
spring.cloud.gateway.routes[5].filters[0]=StripPrefix=2

spring.cloud.gateway.routes[6].id=ws-news
spring.cloud.gateway.routes[6].uri=lb://ws-news
spring.cloud.gateway.routes[6].predicates[0]=Path=/api/news/**
spring.cloud.gateway.routes[6].filters[0]=StripPrefix=2

# CORS configuration (overridden by SecurityConfig when oauth2 profile is active)
# SECURITY: Do not use allowedOrigins=* with allowCredentials=true
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedOriginPatterns=https://*.wizardsofts.com,http://localhost:3000
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedMethods=GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedHeaders=*
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowCredentials=true

# =============================================================================
# OAuth2 Authentication
# =============================================================================
# To enable OAuth2 authentication, activate the 'oauth2' profile:
# java -jar gateway-service.jar --spring.profiles.active=oauth2
# Or set: SPRING_PROFILES_ACTIVE=oauth2
#
# Required environment variables for oauth2 profile:
# - KEYCLOAK_ISSUER_URI: https://id.wizardsofts.com/realms/wizardsofts
# - KEYCLOAK_JWK_SET_URI: https://id.wizardsofts.com/realms/wizardsofts/protocol/openid-connect/certs
# =============================================================================