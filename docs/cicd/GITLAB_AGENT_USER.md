# GitLab Agent User - Automation Account

**Last Updated:** 2026-01-05
**GitLab URL:** http://10.0.0.84:8090
**Status:** ‚úÖ Configured and Active

---

## User Details

**Username:** `agent`
**Email:** `agent@wizardsofts.local`
**Name:** Agent User
**Role:** User (Owner of all groups)
**Status:** Active & Confirmed

**Password:** `wLlrcN0l_elcHwfggKlvMUJVPK-ofuTs`

‚ö†Ô∏è **IMPORTANT:** This password is for automation only. Change if compromised:
1. Login to GitLab: http://10.0.0.84:8090
2. Go to User Settings ‚Üí Password
3. Set a new secure password
4. Update automation scripts and documentation

---

## Purpose

This user is dedicated for **automated operations** including:
- CI/CD pipeline automation
- Automated merge request creation
- GitLab variable management via scripts
- Runner registration and management
- Automated code deployments

**NOT for:**
- Human/manual GitLab access (use mashfiqur.rahman instead)
- Interactive code reviews
- Administrative tasks (use mashfiqur.rahman admin account)

---

## Permissions & Capabilities

### ‚úÖ Full Repository Access (Owner Level)

As Owner of all groups, this user can:

**Merge Request Management:**
- ‚úÖ Create merge requests
- ‚úÖ Review merge requests
- ‚úÖ Approve merge requests
- ‚úÖ Merge to any branch (including protected branches)
- ‚úÖ Manage merge request approvals

**CI/CD Pipeline Management:**
- ‚úÖ View all pipelines
- ‚úÖ Modify `.gitlab-ci.yml` files
- ‚úÖ Trigger manual pipelines
- ‚úÖ Retry/Cancel pipelines
- ‚úÖ Configure pipeline schedules

**GitLab Variables:**
- ‚úÖ View all project/group variables
- ‚úÖ Create/Update/Delete variables
- ‚úÖ Manage protected/masked variables
- ‚úÖ Access environment-specific variables

**GitLab Runner Management:**
- ‚úÖ View all runners (shared & specific)
- ‚úÖ Register new runners
- ‚úÖ Configure runner settings
- ‚úÖ Enable/Disable runners
- ‚úÖ Manage runner tags

**Repository Access:**
- ‚úÖ Full access to all repositories
- ‚úÖ Clone/Pull/Push to any branch
- ‚úÖ Manage protected branches
- ‚úÖ Create/Delete branches

---

## Group Memberships

| Group | Access Level |
|-------|--------------|
| **wizardsofts** | Owner |
| **gibd** | Owner |
| **dailydeenguide** | Owner |

---

## Project Access

**Full Owner access to:**
- wizardsofts/wizardsofts-megabuild
- wizardsofts/mymuezzin
- wizardsofts/gibd-news-service
- wizardsofts/www.wizardsofts.com
- gibd/gibd-web-scraper
- gibd/quant-flow
- gibd/gibd-config
- gibd/mcp-financial-tools
- gibd/gibd-discovery-service
- gibd/gibd-gateway
- gibd/gibd-intelligence
- And all other projects in the groups

---

## Automation Use Cases

### 1. Create Merge Request via API

```bash
# Using GitLab API with agent user credentials
curl --request POST \
  --header "PRIVATE-TOKEN: <agent-user-token>" \
  --header "Content-Type: application/json" \
  --data '{
    "source_branch": "feature/automation",
    "target_branch": "master",
    "title": "Automated feature update",
    "description": "ü§ñ Generated by automation"
  }' \
  "http://10.0.0.84:8090/api/v4/projects/:id/merge_requests"
```

### 2. Update CI/CD Variables

```bash
# Add/Update variable via API
curl --request POST \
  --header "PRIVATE-TOKEN: <agent-user-token>" \
  --form "key=NEW_VARIABLE" \
  --form "value=new_value" \
  --form "protected=false" \
  "http://10.0.0.84:8090/api/v4/projects/:id/variables"
```

### 3. Trigger Pipeline

```bash
# Trigger pipeline via API
curl --request POST \
  --header "PRIVATE-TOKEN: <agent-user-token>" \
  --form "ref=master" \
  --form "variables[DEPLOY_ENV]=production" \
  "http://10.0.0.84:8090/api/v4/projects/:id/pipeline"
```

### 4. Register GitLab Runner

```bash
# Register runner as agent user
gitlab-runner register \
  --non-interactive \
  --url "http://10.0.0.84:8090" \
  --registration-token "<token-from-gitlab>" \
  --executor "docker" \
  --docker-image "alpine:latest" \
  --description "Agent Runner"
```

---

## API Access

### Create Personal Access Token

1. Login as agent user: http://10.0.0.84:8090
2. User Settings ‚Üí Access Tokens
3. Name: "Automation API Access"
4. Scopes: `api`, `read_repository`, `write_repository`
5. Click "Create personal access token"
6. **Save the token immediately** (shown only once)

### Use Token for Automation

```bash
# Git clone with token
git clone http://agent:<token>@10.0.0.84:8090/wizardsofts/project.git

# API request with token
curl --header "PRIVATE-TOKEN: <token>" \
  "http://10.0.0.84:8090/api/v4/projects"
```

---

## Security Best Practices

### Password Management

1. ‚úÖ Store password in secrets manager (e.g., GitLab CI/CD variables)
2. ‚úÖ Never commit password to git repositories
3. ‚úÖ Never share password in Slack/email
4. ‚úÖ Rotate password every 90 days
5. ‚úÖ Use personal access tokens for API access (not password)

### Access Token Management

**Create tokens with minimal required scopes:**
```bash
# For read-only automation
Scopes: read_api, read_repository

# For CI/CD automation
Scopes: api, write_repository

# For runner registration
Scopes: api
```

**Token rotation:**
- Rotate tokens every 90 days
- Create new token before revoking old one
- Update automation scripts with new token
- Revoke old token after verification

### Audit Logging

**Monitor agent user activity:**
```bash
# View recent commits
curl --header "PRIVATE-TOKEN: <token>" \
  "http://10.0.0.84:8090/api/v4/users/agent/events"

# View MR activity
curl --header "PRIVATE-TOKEN: <token>" \
  "http://10.0.0.84:8090/api/v4/merge_requests?author_username=agent"
```

---

## Troubleshooting

### Can't Login

**Reset password via Rails console:**
```bash
ssh agent@10.0.0.84 "sudo docker exec -i gitlab gitlab-rails runner - << 'RUBY'
user = User.find_by(username: 'agent')
user.password = 'NewSecurePassword123!'
user.password_confirmation = 'NewSecurePassword123!'
user.save(validate: false)
puts \"Password reset successfully\"
RUBY
"
```

### Locked Out of Repository

**Verify project access:**
```bash
ssh agent@10.0.0.84 "sudo docker exec -i gitlab gitlab-rails runner - << 'RUBY'
user = User.find_by(username: 'agent')
project = Project.find_by_full_path('wizardsofts/project-name')
puts \"Access level: #{project.team.max_member_access(user.id)}\"
# 50 = Owner, 40 = Maintainer, 30 = Developer
RUBY
"
```

### API Token Not Working

**Verify token is active:**
```bash
curl --header "PRIVATE-TOKEN: <token>" \
  "http://10.0.0.84:8090/api/v4/user"
# Should return agent user details
```

---

## Comparison with Admin User

| Feature | agent (Automation) | mashfiqur.rahman (Admin) |
|---------|-------------------|-------------------------|
| **Role** | User | Administrator |
| **Purpose** | Automation | Human access |
| **Admin Access** | ‚ùå No | ‚úÖ Yes |
| **Repository Access** | ‚úÖ Owner (all groups) | ‚úÖ Owner (all groups) |
| **Create MRs** | ‚úÖ Yes | ‚úÖ Yes |
| **Merge MRs** | ‚úÖ Yes | ‚úÖ Yes |
| **CI/CD Variables** | ‚úÖ Yes | ‚úÖ Yes |
| **Manage Runners** | ‚úÖ Yes | ‚úÖ Yes |
| **Manage Users** | ‚ùå No | ‚úÖ Yes |
| **System Settings** | ‚ùå No | ‚úÖ Yes |

**Use agent for:** Automation, CI/CD, scripts
**Use mashfiqur.rahman for:** Human access, system administration

---

## Related Documentation

- [GITLAB_DEPLOYMENT.md](GITLAB_DEPLOYMENT.md) - GitLab deployment guide
- [GITLAB_ADMIN_USER.md](GITLAB_ADMIN_USER.md) - Admin user (mashfiqur.rahman) documentation
- [AGENT_USER_SETUP.md](AGENT_USER_SETUP.md) - System agent user setup
- [GITLAB_BRANCH_PROTECTION.md](GITLAB_BRANCH_PROTECTION.md) - Branch protection rules

---

**User Created:** 2026-01-05
**Access Level:** User (Owner of all groups)
**Status:** Active & Confirmed

‚ö†Ô∏è **This is an automation account - Use personal access tokens for API access, not password authentication.**
