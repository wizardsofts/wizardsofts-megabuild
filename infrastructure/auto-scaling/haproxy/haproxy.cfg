global
    log stdout format raw local0
    maxconn 4096
    stats socket /tmp/haproxy.sock mode 660 level admin expose-fd listeners
    pidfile /tmp/haproxy.pid
    stats timeout 30s

defaults
    log     global
    mode    http
    option  httplog
    option  dontlognull
    timeout connect 5000
    timeout client  50000
    timeout server  50000

# Stats page
listen stats
    bind *:8404
    stats enable
    stats uri /
    stats refresh 5s
    stats show-legends
    stats show-node

# Ollama backend
frontend ollama_frontend
    bind *:11434
    default_backend ollama_backend

backend ollama_backend
    balance roundrobin
    option httpchk GET /api/tags
    http-check expect status 200
    # Servers will be added dynamically by autoscaler

# Additional services would be added here as needed
# The backends will be managed dynamically by the autoscaler application
