# Server Hardening Configuration
# Copy this file to .env and fill in your actual values
# IMPORTANT: Never commit .env to version control

# ============================================================================
# SERVER DETAILS
# ============================================================================

# Target server IP address for hardening
TARGET_IP=10.0.0.84

# SSH username on target server
TARGET_USER=wizardsofts

# SSH port (default: 22)
SSH_PORT=22

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================

# Local subnet for SSH access restriction (CIDR format)
# After hardening, SSH will ONLY be accessible from this subnet
LOCAL_SUBNET=10.0.0.0/24

# Allowed SSH source IPs/networks (space-separated, optional)
# Examples: "10.0.0.0/24" or "10.0.0.10 10.0.0.20"
ALLOWED_SSH_SOURCES=10.0.0.0/24

# ============================================================================
# EXECUTION CONFIGURATION
# ============================================================================

# Execution mode: apply, check, or rollback
# - apply: Make actual changes to the server
# - check: Validate current compliance status (no changes)
# - rollback: Revert changes from previous apply
EXECUTION_MODE=apply

# Enable dry-run mode (validate without making changes)
# DRY_RUN=true
DRY_RUN=false

# ============================================================================
# LOGGING & MONITORING
# ============================================================================

# Log file directory (created if doesn't exist)
LOG_DIR=hardening/logs

# Enable verbose logging
VERBOSE=true

# Email for notifications (optional)
# NOTIFICATION_EMAIL=admin@example.com

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# Enforce password policy
ENFORCE_PASSWORD_POLICY=true

# Minimum password length
PASSWORD_MIN_LENGTH=12

# Maximum password age (days)
PASSWORD_MAX_DAYS=90

# Minimum password age (days)
PASSWORD_MIN_DAYS=1

# Password warning days before expiration
PASSWORD_WARN_DAYS=14

# ============================================================================
# SERVICE CONFIGURATION
# ============================================================================

# Services to disable (space-separated)
SERVICES_TO_DISABLE="bluetooth cups avahi-daemon"

# Enable Docker hardening
HARDEN_DOCKER=true

# Docker daemon socket permissions
DOCKER_SOCKET_MODE=660

# ============================================================================
# KERNEL HARDENING
# ============================================================================

# Enable kernel module restrictions
RESTRICT_KERNEL_MODULES=true

# Blacklist uncommon filesystems
BLACKLIST_FILESYSTEMS=true

# Apply sysctl hardening parameters
APPLY_SYSCTL_HARDENING=true

# ============================================================================
# MONITORING & DETECTION
# ============================================================================

# Install and configure Fail2Ban
INSTALL_FAIL2BAN=true

# Fail2Ban SSH jail maxretry (3-5 recommended)
FAIL2BAN_MAXRETRY=3

# Fail2BAN findtime (seconds to check for failed attempts)
FAIL2BAN_FINDTIME=600

# Fail2Ban bantime (seconds to ban after maxretry)
FAIL2BAN_BANTIME=3600

# Install and configure auditd
INSTALL_AUDITD=true

# Enable remote logging
REMOTE_LOGGING_ENABLED=false

# Remote syslog server (IP or hostname)
REMOTE_LOG_SERVER=

# Remote syslog port
REMOTE_LOG_PORT=514

# ============================================================================
# BACKUP & RECOVERY
# ============================================================================

# Create backups before making changes
CREATE_BACKUPS=true

# Backup directory
BACKUP_DIR=/tmp/hardening_backups

# Keep backup files (for rollback)
KEEP_BACKUPS=true

# ============================================================================
# ADVANCED OPTIONS
# ============================================================================

# Timeout for SSH commands (seconds)
SSH_TIMEOUT=30

# Maximum number of retries for failed commands
MAX_RETRIES=3

# Enable debug mode (very verbose output)
DEBUG=false

# Skip pre-flight checks
SKIP_PREFLIGHT_CHECKS=false

# Stop on first error
STOP_ON_ERROR=true
